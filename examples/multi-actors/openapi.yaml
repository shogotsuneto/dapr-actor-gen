openapi: 3.0.3
info:
  title: Multi-Actor API with Enums
  description: |
    Dapr Actor API specification demonstrating enum usage across multiple actor types.
    
    This specification demonstrates:
    - **CounterActor**: Counter with operating modes using the CounterMode enum
    - **BankAccountActor**: Banking operations with account status using the AccountStatus enum
    
    **Enum Features Demonstrated**:
    - Type-safe enum constants with validation
    - Enum usage in request/response schemas
    - Enum integration with actor methods
    - Multi-actor enum usage patterns
    
    **Generated from**: This specification serves as the schema-first definition
    for generating Go interfaces, types, and enum constants.
  version: 2.0.0
  contact:
    name: Dapr Actor Gen - Enum Demo
    url: https://github.com/shogotsuneto/dapr-actor-gen
  license:
    name: MIT

servers:
  - url: http://localhost:3500/v1.0/actors
    description: Local Dapr sidecar (default configuration)

paths:
  # Counter paths demonstrating enum usage
  /Counter/{actorId}/state:
    get:
      summary: Get counter state with mode information
      description: |
        Retrieves the current counter state including the operating mode.
        Demonstrates enum usage in response data.
      parameters:
        - $ref: '#/components/parameters/ActorId'
      responses:
        '200':
          description: Current counter state with enum mode
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CounterState'

  /Counter/{actorId}/method/Configure:
    post:
      summary: Configure counter mode
      description: |
        Configures the counter's operating mode using the CounterMode enum.
        Demonstrates enum usage in request validation.
      parameters:
        - $ref: '#/components/parameters/ActorId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfigureCounterRequest'
      responses:
        '200':
          description: Counter configured successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CounterState'

  /Counter/{actorId}/method/Increment:
    post:
      summary: Increment the counter
      description: |
        Increments the counter value. Mode validation ensures operation compatibility.
      parameters:
        - $ref: '#/components/parameters/ActorId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IncrementRequest'
      responses:
        '200':
          description: Counter incremented successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CounterState'

  /Counter/{actorId}/method/Decrement:
    post:
      summary: Decrement the counter
      description: |
        Decrements the counter value. Mode validation ensures operation compatibility.
      parameters:
        - $ref: '#/components/parameters/ActorId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DecrementRequest'
      responses:
        '200':
          description: Counter decremented successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CounterState'

  /Counter/{actorId}/method/SetValue:
    post:
      summary: Set counter to specific value
      description: |
        Sets the counter to a specific value. Mode validation controls access.
      parameters:
        - $ref: '#/components/parameters/ActorId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetValueRequest'
      responses:
        '200':
          description: Counter value set successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CounterState'

  # BankAccount paths demonstrating enum usage
  /BankAccount/{actorId}/method/CreateAccount:
    post:
      summary: Create new bank account with initial status
      description: |
        Creates a new bank account with initial account status.
        Demonstrates enum usage for account status management.
      parameters:
        - $ref: '#/components/parameters/ActorId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAccountRequest'
      responses:
        '200':
          description: Account created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BankAccountState'

  /BankAccount/{actorId}/method/UpdateStatus:
    post:
      summary: Update account status
      description: |
        Updates the account status using the AccountStatus enum.
        Demonstrates enum-based status transitions and validation.
      parameters:
        - $ref: '#/components/parameters/ActorId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateStatusRequest'
      responses:
        '200':
          description: Account status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BankAccountState'

  /BankAccount/{actorId}/method/GetAccount:
    get:
      summary: Get current account information
      description: |
        Gets current account information including status.
        Shows enum values in response data.
      parameters:
        - $ref: '#/components/parameters/ActorId'
      responses:
        '200':
          description: Current account state with enum values
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BankAccountState'

components:
  parameters:
    ActorId:
      name: actorId
      in: path
      required: true
      description: |
        Unique identifier for the actor instance. Each actor ID maintains
        independent state within its actor type.
      schema:
        type: string
        pattern: '^[a-zA-Z0-9_-]+$'
        minLength: 1
        maxLength: 50
      example: "counter-123"

  schemas:
    # ========================================
    # ENUM DEFINITIONS - Core Feature Demo
    # ========================================
    
    CounterMode:
      type: string
      enum: ["Manual", "Automatic", "Scheduled", "Triggered"]
      description: Operating mode for the counter actor
      example: "Manual"

    AccountStatus:
      type: string
      enum: ["Active", "Suspended", "Closed", "Pending", "Frozen"]
      description: Current status of the bank account
      example: "Active"

    # ========================================
    # COUNTER ACTOR SCHEMAS
    # ========================================

    CounterState:
      type: object
      description: Current state of the counter actor with enum-based configuration
      required:
        - value
        - mode
        - isEnabled
      properties:
        value:
          type: integer
          format: int32
          description: The current counter value
          example: 42
        mode:
          $ref: '#/components/schemas/CounterMode'
        isEnabled:
          type: boolean
          description: Whether the counter is currently enabled
          example: true
        lastModified:
          type: string
          format: date-time
          description: When the counter was last modified
          example: "2024-01-15T10:30:00Z"
        metadata:
          type: object
          description: Additional counter metadata
          additionalProperties: true
          example:
            tags: ["production", "metrics"]
            owner: "system"
      additionalProperties: false

    ConfigureCounterRequest:
      type: object
      description: Request to configure counter mode
      required:
        - mode
      properties:
        mode:
          $ref: '#/components/schemas/CounterMode'
        isEnabled:
          type: boolean
          description: Enable or disable the counter
          default: true
        metadata:
          type: object
          description: Optional metadata for the counter
          additionalProperties: true
          example:
            owner: "admin"
            purpose: "user-session-tracking"
      additionalProperties: false

    IncrementRequest:
      type: object
      description: Request to increment counter
      properties:
        step:
          type: integer
          format: int32
          description: How much to increment by
          minimum: 1
          default: 1
          example: 1
        reason:
          type: string
          description: Reason for the increment operation
          maxLength: 200
          example: "User login event"
      additionalProperties: false

    DecrementRequest:
      type: object
      description: Request to decrement counter
      properties:
        step:
          type: integer
          format: int32
          description: How much to decrement by
          minimum: 1
          default: 1
          example: 1
        reason:
          type: string
          description: Reason for the decrement operation
          maxLength: 200
          example: "User logout event"
      additionalProperties: false

    SetValueRequest:
      type: object
      description: Request to set counter to specific value
      required:
        - value
      properties:
        value:
          type: integer
          format: int32
          description: The value to set the counter to
          minimum: -2147483648
          maximum: 2147483647
          example: 100
        reason:
          type: string
          description: Reason for setting the value
          maxLength: 200
          example: "Reset for new month"
      additionalProperties: false

    # ========================================
    # BANKACCOUNT ACTOR SCHEMAS
    # ========================================

    BankAccountState:
      type: object
      description: Current state of the bank account actor with enum-based status
      required:
        - accountId
        - balance
        - status
      properties:
        accountId:
          type: string
          description: Unique identifier for the bank account
          example: "ACC-12345"
        balance:
          type: number
          format: double
          description: Current account balance
          example: 1250.75
        status:
          $ref: '#/components/schemas/AccountStatus'
        isEnabled:
          type: boolean
          description: Whether the account is currently enabled for transactions
          default: true
          example: true
        lastModified:
          type: string
          format: date-time
          description: When the account was last modified
          example: "2024-01-15T10:30:00Z"
        metadata:
          type: object
          description: Additional account metadata
          additionalProperties: true
          example:
            branch: "downtown"
            accountType: "savings"
      additionalProperties: false

    CreateAccountRequest:
      type: object
      description: Request to create a new bank account
      required:
        - accountId
        - initialBalance
      properties:
        accountId:
          type: string
          description: Unique identifier for the new account
          pattern: '^ACC-[0-9]+$'
          example: "ACC-12345"
        initialBalance:
          type: number
          format: double
          description: Initial balance for the account
          minimum: 0
          example: 100.00
        status:
          $ref: '#/components/schemas/AccountStatus'
          description: Initial account status (defaults to Pending)
        metadata:
          type: object
          description: Optional metadata for the account
          additionalProperties: true
          example:
            branch: "downtown"
            accountType: "savings"
      additionalProperties: false

    UpdateStatusRequest:
      type: object
      description: Request to update account status
      required:
        - status
      properties:
        status:
          $ref: '#/components/schemas/AccountStatus'
        reason:
          type: string
          description: Reason for the status change
          maxLength: 200
          example: "Account verification completed"
        metadata:
          type: object
          description: Optional metadata for the status change
          additionalProperties: true
      additionalProperties: false